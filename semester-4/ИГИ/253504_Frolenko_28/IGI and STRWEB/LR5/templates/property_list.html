{% extends 'base.html' %}

{% block content %}
<h2>Список объектов недвижимости</h2>

<form method="get" class="form-inline">
    <input type="text" name="query" placeholder="Поиск..." value="{{ request.GET.query }}" class="form-control">
    <select name="sort" class="form-control">
        <option value="title">По названию</option>
        <option value="price">По цене</option>
        <option value="year_built">По году постройки</option>
    </select>
    <button type="submit" class="btn btn-primary">Поиск</button>
</form>

<table class="table">
    <thead>
        <tr>
            <th>Название</th>
            <th>Описание</th>
            <th>Цена</th>
            <th>Действия</th>
        </tr>
    </thead>
    <tbody>
        {% for property in object_list %}
        <tr>
            <td>{{ property.title }}</td>
            <td>{{ property.description }}</td>
            <td>{{ property.price }}</td>
            <td>
                {% if request.user.is_authenticated %}
                    <a href="{% url 'property-detail' property.id %}" class="btn btn-primary">Подробнее</a>
                    {% if request.user.role == 'employee' or request.user.role == 'admin' %}
                        <a href="{% url 'property-update' property.id %}" class="btn btn-secondary">Редактировать</a>
                        <a href="{% url 'property-delete' property.id %}" class="btn btn-danger">Удалить</a>
                    {% endif %}
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}
