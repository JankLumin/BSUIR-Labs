<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>График функции и ряда</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </head>
  <body>
    <canvas id="chart" width="800" height="400"></canvas>
    <script>
      // Функция для вычисления значения ряда для ln((x+1)/(x-1))
      function seriesApproximation(x, terms) {
        let sum = 0;
        for (let n = 0; n < terms; n++) {
          sum += 1 / ((2 * n + 1) * Math.pow(x, 2 * n + 1));
        }
        return 2 * sum;
      }

      // Функция для вычисления значения ln((x+1)/(x-1)) через Math
      function mathFunction(x) {
        return Math.log((x + 1) / (x - 1));
      }

      // Подготовка данных для графика с 100 точками
      const xValues = [];
      const seriesData = [];
      const mathData = [];
      const terms = 10; // Количество членов ряда
      const numPoints = 100;
      const xStart = 1;
      const xEnd = 2;
      const step = (xEnd - xStart) / numPoints;

      for (let i = 0; i < numPoints; i++) {
        const x = xStart + i * step;
        xValues.push(x.toFixed(2));
        seriesData.push(seriesApproximation(x, terms));
        mathData.push(mathFunction(x));
      }

      // Создаем пустой график, данные будем добавлять постепенно
      const ctx = document.getElementById("chart").getContext("2d");
      const chart = new Chart(ctx, {
        type: "line",
        data: {
          labels: [], // Пустые метки и данные, будем добавлять их постепенно
          datasets: [
            {
              label: "Разложение в ряд",
              data: [],
              borderColor: "blue",
              fill: false,
              tension: 0.1,
            },
            {
              label: "Функция ln((x+1)/(x-1))",
              data: [],
              borderColor: "red",
              fill: false,
              tension: 0.1,
            },
          ],
        },
        options: {
          responsive: true,
          plugins: {
            legend: {
              display: true,
              position: "top",
            },
          },
          scales: {
            x: {
              title: {
                display: true,
                text: "x",
              },
            },
            y: {
              title: {
                display: true,
                text: "F(x)",
              },
            },
          },
        },
      });

      // Функция для добавления одной точки на график
      let index = 0;
      function addPoint() {
        if (index < numPoints) {
          chart.data.labels.push(xValues[index]);
          chart.data.datasets[0].data.push(seriesData[index]);
          chart.data.datasets[1].data.push(mathData[index]);
          chart.update();
          index++;
        } else {
          clearInterval(animation); // Останавливаем анимацию после добавления всех точек
        }
      }

      // Запускаем анимацию добавления точек
      const animation = setInterval(addPoint, 100); // 100 миллисекунд на точку
    </script>
  </body>
</html>
