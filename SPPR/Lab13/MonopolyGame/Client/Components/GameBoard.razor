@page "/gameboard"
@using MonopolyGame.Shared.Models
@inject ClientGameLogic gameLogic

<h3>Игровое поле</h3>

@if (gameState == null)
{
    <p>Загрузка игры...</p>
}
else
{
    <div>
        <h4>Статус игры: @gameState.Status</h4>
        <p>Текущий ход: @gameState.CurrentTurn</p>

        <div class="board">
            @foreach (var property in gameState.Properties)
            {
                <div class="property">
                    <p>@property.Name</p>
                    <p>Владелец: @property.Owner?.Name ?? "Нет владельца"</p>
                </div>
            }
        </div>

        <button class="btn btn-primary" @onclick="MakeMove">Сделать ход</button>
    </div>
}

@code {
    private GameState gameState;

    protected override async Task OnInitializedAsync()
    {
        gameState = await gameLogic.GetGameStateAsync();
        gameLogic.GameStateChanged += GameStateChanged;
    }

    private void GameStateChanged(GameState newState)
    {
        gameState = newState;
        StateHasChanged();
    }

    private async Task MakeMove()
    {
        await gameLogic.MakeMove();
    }

    public void Dispose()
    {
        gameLogic.GameStateChanged -= GameStateChanged;
    }
}
